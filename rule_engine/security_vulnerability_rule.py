import ast
from reports.report import Report

class SecurityVulnerabilityRule:
    def apply(self, ast_tree, file_name, report_generator):
        vulnerable_functions = ['eval', 'exec', 'input']
        for node in ast.walk(ast_tree):
            if isinstance(node, ast.Call) and isinstance(node.func, ast.Name):
                if node.func.id in vulnerable_functions:
                    warning_message = f"Use of vulnerable function '{node.func.id}' detected."
                    print(warning_message)

                    # Generate report and add to report generator
                    report = Report(file_name=file_name, rule_type="security_vulnerability", message=warning_message, line_number=node.lineno)
                    report_generator.add_report(report)
